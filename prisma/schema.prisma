// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Device {
  id           Int          @id @default(autoincrement())
  serialNumber String       @unique
  model        String
  registeredAt DateTime     @default(now())
  isActive     Boolean      @default(true)
  dataRecords  DataRecord[]
  userId       String
  User         User?        @relation(name: "UserDevices", fields: [userId], references: [id])

  currentValue Float?
  currentUnit  String?
  currentAt    DateTime?
}

model DataRecord {
  id           Int      @id @default(autoincrement())
  device       Device   @relation(fields: [deviceId], references: [id])
  deviceId     Int
  timestamp    DateTime
  value        Float
  unit         String
  recordNumber Int
  serialNumber String   @default("")
  rawData      String   @default("")
}

model User {
  id        String    @id @default(uuid())
  name      String
  email     String    @unique
  password  String
  createdAt DateTime  @default(now())
  deletedAt DateTime?
  devices   Device[]  @relation(name: "UserDevices")
  provider  String    @default("local")
}
